
# TableBot-Pipe Advanced üöÄ

> **TableBot-Pipe Advanced** ‚Äî —ç—Ç–æ —ç–≤–æ–ª—é—Ü–∏—è [TableBot-Pipe](https://github.com/...), —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö Telegram-–±–æ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ CSV/XLSX —Ç–∞–±–ª–∏—Ü.

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç **–æ–ø–∏—Å–∞—Ç—å –≤—Å—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –±–æ—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ**, –∞ Python-–∫–æ–¥ –æ—Ç–≤–µ—á–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –∑–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é** –∏ **—Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é**. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ `tablebot-pipe`, **Advanced** –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è **–º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤**, **–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** –∏ **–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏**.

## üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

*   **–í—Å—ë –≤ —Ç–∞–±–ª–∏—Ü–µ:** –°–æ—Å—Ç–æ—è–Ω–∏—è, –ø–µ—Ä–µ—Ö–æ–¥—ã, —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–Ω–æ–ø–∫–∏, —É—Å–ª–æ–≤–∏—è, —ç—Ñ—Ñ–µ–∫—Ç—ã, –ø—Ä–æ–≥—Ä–µ—Å—Å ‚Äî –≤—Å—ë –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ `table_final.csv` (–∏–ª–∏ XLSX).
*   **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (find_row, check_guard, execute_effect, build_message, –∏ —Ç.–¥.).
*   **–ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–µ—Å—Å–∏–∏:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–∫—Ç–æ—Ä–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ö–ª–∏–µ–Ω—Ç, –í–æ–¥–∏—Ç–µ–ª—å, –û–ø–µ—Ä–∞—Ç–æ—Ä).
*   **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏ –≤ –¥—Ä—É–≥—É—é (—á–µ—Ä–µ–∑ `result_action: notify_user_by_chat_id:<target_chat_id>:<message_template>`).
*   **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç—Ä–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —á–µ—Ä–µ–∑ –∫–æ–ª–æ–Ω–∫—É `progress_config` –≤ —Ç–∞–±–ª–∏—Ü–µ.
*   **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ FSM:** –°–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞–±–ª–∏—Ü—ã.
*   **–ö–æ–º–∞–Ω–¥–Ω–æ–µ –º–µ–Ω—é:** –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–µ–Ω—é –±–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ –∫–æ–ª–æ–Ω–æ–∫ `bot_command` –∏ `bot_description` –≤ —Ç–∞–±–ª–∏—Ü–µ.
*   **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–∞ –≤–Ω–µ—à–Ω–∏—Ö HTTP-—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π.
*   **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** –ö–æ–¥ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è, –¥–æ–±–∞–≤–ª—è—è –Ω–æ–≤—ã–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
*   **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ XLSX:** –†–∞–±–æ—Ç–∞ –∫–∞–∫ —Å CSV, —Ç–∞–∫ –∏ —Å Excel-—Ñ–∞–π–ª–∞–º–∏ (XLSX).

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```text
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -> Telegram -> 08_core_loop.py -> pipeline/ -> –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                                    ‚Üì
                              table_final.csv
```

*   **`08_core_loop.py`**: –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –±–æ—Ç–∞, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ callback'–æ–≤.
*   **`pipeline/`**: –ù–∞–±–æ—Ä –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö Python-–º–æ–¥—É–ª–µ–π, –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞.
*   **`table_final.csv`**: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ª–æ–≥–∏–∫–∏ –±–æ—Ç–∞.
*   **`core/`**: –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã (–∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–∞, —Ç–∞–±–ª–∏—Ü—ã, FSM, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π).
*   **`handlers/`**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π (—Å–æ–æ–±—â–µ–Ω–∏—è, –∫–Ω–æ–ø–∫–∏).

## üöÄ –ó–∞–ø—É—Å–∫

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone https://github.com/your-username/tablebot-pipe-advanced.git
    cd tablebot-pipe-advanced
    ```

2.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install -r requirements.txt
    ```
    *(–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `requirements.txt` –≤–∫–ª—é—á–∞–µ—Ç `aiogram`, `pandas`, `openpyxl` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ XLSX)*

3.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:**
    *   –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏–ª–∏ `token.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.
    *   –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É: `BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–∫–µ–Ω_–æ—Ç_botfather`

4.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É:**
    *   –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `table_final.csv` (–∏–ª–∏ `table.xlsx`) –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–µ–π –ª–æ–≥–∏–∫–æ–π.
    *   –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∫–æ–ª–æ–Ω–∫–∏ `bot_command`, `bot_description` –∏ `progress_config`.

5.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
    ```bash
    python 08_core_loop.py table_final.csv
    # –∏–ª–∏
    python 08_core_loop.py table.xlsx
    ```

## üìä –§–æ—Ä–º–∞—Ç —Ç–∞–±–ª–∏—Ü—ã

–§–æ—Ä–º–∞—Ç —Ç–∞–±–ª–∏—Ü—ã `table_final.csv` (–∏–ª–∏ `table.xlsx`) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Å—é –ª–æ–≥–∏–∫—É –±–æ—Ç–∞. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç *–ø–µ—Ä–µ—Ö–æ–¥* –∏–∑ –æ–¥–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –¥—Ä—É–≥–æ–µ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º *–≤–≤–æ–¥–µ*.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| :--- | :--- | :--- |
| `process_name` | –ò–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ª–æ–≥–∏–∫–∏ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, —á–∞—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞) | `TestBot`, `PizzaOrder` |
| `from_state` | –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | `start`, `menu`, `step1` |
| `to_state` | –¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–π–¥—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | `menu`, `step1`, `step2` |
| `command` | –ö–æ–º–∞–Ω–¥–∞ –∏–ª–∏ —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –≤–≤–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ | `/start`, `–î–∞–ª–µ–µ`, `<text>` (–ª—é–±–æ–π —Ç–µ–∫—Å—Ç) |
| `condition` | –£—Å–ª–æ–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `not_empty:text`, `equals:user_type:admin` |

### –ö–æ–ª–æ–Ω–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| :--- | :--- | :--- |
| `message_text` | –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç –±–æ—Ç | `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!`, `–®–∞–≥ 1 –∏–∑ 3` |
| `caption` | –ü–æ–¥–ø–∏—Å—å –∫ –º–µ–¥–∏–∞—Ñ–∞–π–ª—É (–µ—Å–ª–∏ `media_file` —É–∫–∞–∑–∞–Ω) | `–ù–∞—à–µ –º–µ–Ω—é` |
| `media_file` | –ü—É—Ç—å –∏–ª–∏ URL –∫ –º–µ–¥–∏–∞—Ñ–∞–π–ª—É (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç –∏ —Ç.–¥.) | `menu.jpg`, `https://example.com/video.mp4` |

### –ö–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| :--- | :--- | :--- |
| `reply_markup` | –û–±—ã—á–Ω—ã–µ (reply) –∫–Ω–æ–ø–∫–∏, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ `\|` | `–î–∞\|–ù–µ—Ç\|–û—Ç–º–µ–Ω–∞` |
| `inline_markup` | Inline-–∫–Ω–æ–ø–∫–∏, —Ñ–æ—Ä–º–∞—Ç: `–¢–µ–∫—Å—Ç:callback_data\|–¢–µ–∫—Å—Ç2:callback_data2` | `–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å:confirm\|–û—Ç–º–µ–Ω–∞:cancel` |

### –ö–æ–ª–æ–Ω–∫–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| :--- | :--- | :--- |
| `notification` | –¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç `message_text`) | `–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç: {order_id}` |
| `integrations` | –û–ø–∏—Å–∞–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ –≤—ã–∑–æ–≤–∞ (HTTP, email –∏ —Ç.–¥.) | `http:POST https://api.com/order` |
| `result_action` | Side-effect –¥–µ–π—Å—Ç–≤–∏—è (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –æ—á–∏—Å—Ç–∫–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –¥—Ä—É–≥–æ–π —á–∞—Ç) | `save:order_id:123`, `clear:temp_data`, `notify_user_by_chat_id:123456789:–ü—Ä–∏–≤–µ—Ç!` |

### –ö–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ –º–µ–Ω—é –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| :--- | :--- | :--- |
| `bot_command` | –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –º–µ–Ω—é –±–æ—Ç–∞ (–¥–æ–ª–∂–Ω–∞ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `/`) | `/start`, `/help` |
| `bot_description` | –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–µ–Ω—é –±–æ—Ç–∞ | `–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞`, `–ü–æ–ª—É—á–∏—Ç—å –ø–æ–º–æ—â—å` |
| `progress_config` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–æ–ø–∏—Å–∞–Ω–∏–µ —Å–º. –Ω–∏–∂–µ) | `manual:1/3`, `track:step_field`, `bar:step_field` |

---

### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ `progress_config`

–ö–æ–ª–æ–Ω–∫–∞ `progress_config` –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ *–≤–Ω—É—Ç—Ä–∏* `message_text`. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:

*   `disabled`: –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏.
*   `manual:current_step/total_steps`: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤–∏–¥–∞ `[–®–∞–≥ current_step/total_steps]`.
*   `track:field_name`: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—Å—Ç –≤–∏–¥–∞ `[–ü—Ä–æ–≥—Ä–µ—Å—Å: –∑–Ω–∞—á–µ–Ω–∏–µ_–∏–∑_payload[field_name]]`.
*   `bar:field_name`: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë`), –∏—Å–ø–æ–ª—å–∑—É—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `payload[field_name]` –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, `payload.get("total_steps_for_bar", 8)`.
*   `track:field_name\|bar:field_name`: –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –±–∞—Ä–∞.

---

### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ `result_action`

–ö–æ–ª–æ–Ω–∫–∞ `result_action` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–±–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:

*   `save:field:value`: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç `value` –≤ `payload[field]`. `value` –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã `{other_field}`, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∏–∑ `payload`.
*   `clear:field`: –£–¥–∞–ª—è–µ—Ç `field` –∏–∑ `payload`.
*   `notify_user_by_chat_id:target_chat_id:message_template`: (–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ Advanced) –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ `message_template` –≤ —á–∞—Ç —Å ID `target_chat_id`. `message_template` –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã `{field}`, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∏–∑ `payload` —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.

---

### –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã

| process_name | from_state | to_state | command | condition | message_text | result_action | progress_config | bot_command | bot_description |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| TestBot | start | menu | /start | | –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ. | save:current_step:1\|save:user_id:{chat_id} | manual:1/3 | /start | –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ |
| TestBot | menu | step1 | –ù–∞—á–∞—Ç—å | | –®–∞–≥ 1. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å. | save:current_step:2 | track:current_step\|bar:current_step | | |
| TestBot | step1 | step2 | `<text>` | | –í—ã –≤–≤–µ–ª–∏: <b>{text}</b>. –ü–µ—Ä–µ—Ö–æ–¥ –∫ —à–∞–≥—É 2. | save:current_step:3\|notify_user_by_chat_id:123456789:–ö–ª–∏–µ–Ω—Ç {user_id} –≤–≤—ë–ª {text} –Ω–∞ —à–∞–≥–µ 1! | track:current_step\|bar:current_step | | |

## üß© –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

*   **–ù–æ–≤—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π:** –î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `core/message_sender/`.
*   **–ù–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã:** –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏–∫—É –≤ `pipeline/execute_effect.py`.
*   **–ù–æ–≤—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä—Å–µ—Ä –≤ `pipeline/prepare_integration.py`.
*   **–ù–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è (guards):** –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏–∫—É –≤ `pipeline/check_guard.py`.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–∏—Ç–æ–≥–æ–≤—ã–π –ª–∏—Å—Ç–∏–Ω–≥)

```
‚îú‚îÄ‚îÄ 08_core_loop.py
‚îú‚îÄ‚îÄ create_test_media.py
‚îú‚îÄ‚îÄ project_analyzer4.py
‚îú‚îÄ‚îÄ table.csv
‚îú‚îÄ‚îÄ table_final.csv
‚îú‚îÄ‚îÄ table_final_back.csv
‚îú‚îÄ‚îÄ table_fixed.csv
‚îú‚îÄ‚îÄ table_pizza.csv
‚îú‚îÄ‚îÄ table_urls.csv
‚îú‚îÄ‚îÄ –∞—Ä—Ö.txt
‚îú‚îÄ‚îÄ .env (–∏–ª–∏ token.env - –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ñ–∞–π–ª)
‚îú‚îÄ‚îÄ requirements.txt (–ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ñ–∞–π–ª)
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ commands_loader.py
‚îÇ   ‚îú‚îÄ‚îÄ fsm_builder.py
‚îÇ   ‚îú‚îÄ‚îÄ message_sender_back.py
‚îÇ   ‚îú‚îÄ‚îÄ pipeline_executor.py
‚îÇ   ‚îú‚îÄ‚îÄ table_loader.py
‚îÇ   ‚îú‚îÄ‚îÄ token_loader.py
‚îÇ   ‚îî‚îÄ‚îÄ message_sender/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ base.py
‚îÇ       ‚îú‚îÄ‚îÄ format_detector.py
‚îÇ       ‚îú‚îÄ‚îÄ markup_builder.py
‚îÇ       ‚îú‚îÄ‚îÄ media_sender.py
‚îÇ       ‚îú‚îÄ‚îÄ poll_sender.py
‚îÇ       ‚îî‚îÄ‚îÄ text_sender.py
‚îú‚îÄ‚îÄ doc/
‚îÇ   ‚îú‚îÄ‚îÄ deepseek_text_20250929_e42670.txt
‚îÇ   ‚îî‚îÄ‚îÄ –ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç.txt
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ callback_handler.py
‚îÇ   ‚îî‚îÄ‚îÄ message_handler.py
‚îî‚îÄ‚îÄ pipeline/
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ build_message.py
    ‚îú‚îÄ‚îÄ check_guard.py
    ‚îú‚îÄ‚îÄ determine_transition.py
    ‚îú‚îÄ‚îÄ execute_effect.py
    ‚îú‚îÄ‚îÄ find_row.py
    ‚îú‚îÄ‚îÄ format_notification.py
    ‚îî‚îÄ‚îÄ prepare_integration.py
```

*(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∑—è—Ç–∞ –∏–∑ `project_overview.txt`. –§–∞–π–ª—ã `.env`, `requirements.txt` –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –æ–∂–∏–¥–∞–µ–º—ã–µ.)*

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
```

---

–≠—Ç–æ—Ç `README.md` —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç:

1.  **–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π.**
2.  **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.**
3.  **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É.**
4.  **–ü–æ–ª–Ω–æ–µ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –≤—Å–µ—Ö –µ—ë —Å—Ç–æ–ª–±—Ü–æ–≤**, –≤–∫–ª—é—á–∞—è `progress_config` –∏ `result_action` —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏.
5.  **–†–∞–∑–¥–µ–ª "–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ".**
6.  **–ò—Ç–æ–≥–æ–≤—ã–π –ª–∏—Å—Ç–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞**, –∫–∞–∫ —Ç–æ–≥–æ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å, –Ω–∞ –æ—Å–Ω–æ–≤–µ `project_overview.txt`.
7.  **–õ–∏—Ü–µ–Ω–∑–∏—é.**